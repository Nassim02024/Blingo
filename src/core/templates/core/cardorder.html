{% load static %}
{% load i18n %}
 
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
   
  <link rel="stylesheet" href="{% static 'core/css/cardorder.css' %}">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <link  href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js">
  <link  href="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <!-- mapbox JS MAP -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.14.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.14.0/mapbox-gl.js"></script>
  <!--// END  mapbox JS MAP //-->
  <title>{% trans 'Document' %}</title>
</head>

<body >
  {% comment %} <img src="{% static "core/images/checkout-order.jpg" %}" alt="checkout" loading="lazy" class="img-fluid imgbg position-fixed" /> {% endcomment %}
  <form
  action="{% url "cardorder" vendor.vid  %}"
  method="POST" 
>
{% csrf_token %}
  <div class="container-fluid my-5 d-sm-flex ">
    <div class="card px-2">
         <center class="p-3"> <h4>{% trans "Details order" %}</h4></center>
        <div class="card-body">
            <div class="media " style="flex-direction: column;width: 100%;">
              
<!-- card order -->
                <div data-product-id="{{p.pid}}" class="media-body align-items-center checking" style="width: 100%;">
                  {% comment %} <div>
                    <img src="{% static "core/images/app-store.jpg" %}" alt="app-store" loading="lazy">
                  </div> {% endcomment %}


                
                  <hr>
                  
                  
                </div>
                <hr>
            </div>
        </div>
        
         <div class="card-footer  bg-white px-sm-3 pt-sm-4 px-0">
            <div class="row text-center  ">
                
              <div class="col  my-auto  border-line "><a href="{% url 'product' vendor.vid  %}" ><h5>{% trans "Order" %}</h5></a></div>
                <div class="col  my-auto  border-line "><a href="{% url "index"  %}" ><h5>{% trans "Cancel" %}</h5></a></div>
                <div class="col  my-auto mx-0 px-0 "><img class="img-fluid cursor-pointer" src="https://img.icons8.com/ios/50/000000/menu-2.png" width="30" height="30"></div>
            </div>
        </div>
    </div>



    <div class="main-center">
      <!-- Author: FormBold Team -->
      <!-- Learn More: https://formbold.com -->
      <div class="form-container">
          <img
              src="https://ucarecdn.com/412d5bde-bec7-49c8-94c9-f6df6434ed12/address.png"
              alt="Address Form Image"
              class="form-img"
              loading="lazy"
          />
        
              <div style="margin-bottom: 2rem">
                  <h2 class="form-title">{% trans "Address Form" %}</h2>
                  <p class="form-desc">
                      {% trans "Please provide your address details below. Fields marked with  are required." %}
                      
                  </p>
              </div>
  
              {% comment %} <label for="fullname" class="form-label">{% trans "Full Name" %}</label>
              <input
                  type="text"
                  name="fullname"
                  id="fullname"
                  class="form-input"
                  placeholder="Enter your full name"
                  required
              />
   {% endcomment %}
              {% comment %} <label for="email" class="form-label">{% trans "Email Address" %}</label>
              <input
                  type="email"
                  name="email"
                  id="email"
                  class="form-input"
                  placeholder="Enter your email"
                  required
          /> {% endcomment %}
  
              <label for="phone" class="form-label"
                  >{% trans 'Phone Number' %}</label
              >
              <input
                  type="tel"
                  name="phone"
                  id="phone"
                  class="form-input"
                  placeholder="Enter your phone number"
              />
  
              <label for="address-line-1" class="form-label"
                  >{% trans 'Street Address (Line 1)*' %}</label
              >
              <input
                  type="text"
                  name="address-line-1"
                  id="address-line-1"
                  class="form-input"
                  placeholder="House No., Road Name, etc."
                  required
              />
  
              <label for="address-line-2" class="form-label"
                  >{% trans 'Street Address (Line 2) (Optional)' %}</label
              >
              <input
                  type="text"
                  name="address-line-2"
                  id="address-line-2"
                  class="form-input"
                  placeholder="Apartment, Suite, Floor, etc."
              />

              <hr >

              <h2>Bill</h2>
              <div  style="display: flex;flex-direction: column; justify-content: space-between; width: 100%;">
                
                <div class="summary" >
                   <p>Order total</p>
                   <p class='summary_order_tolal'></p>
                </div>
                  
                <div class="summary">
                   <p>Delivery service </p>
                   <p class="summary_Delivery_service">  </p>
                </div>

                <div class="summary">
                   <h5>Total</h3> 
                    <h5 class="summary_order_all"> </h5>
                </div>
                
              </div>
  
              <div class="form-checkbox-row">
                  <input
                      type="checkbox"
                      id="declaration"
                      class="form-checkbox"
                      required
                  />
                  <label
                      for="declaration"
                      style="margin: 0; font-weight: 500"
                      class="form-label">
                      {% blocktrans %}I confirm this address is accurate for {% endblocktrans %} {{request.user}}
                    </label>
              </div>
              
                
              <button   type="submit" class="form-btn">{% trans 'Submit Address' %}</button>


      </div>
  </div>
        

</div>
</form>

<div id="map" style=""></div>

<!-- Location -->
{% block scripts %}

<script>

  mapboxgl.accessToken = 'pk.eyJ1IjoiYmxpbmdvIiwiYSI6ImNtZjU5cHB1aDAzY3cya3M5Y3BuN291bjEifQ.fZnLg8Uql1f2NegnAp6Bdw';

navigator.geolocation.getCurrentPosition((pos) => {
  const lng = pos.coords.longitude;
  const lat = pos.coords.latitude;

  // إنشاء الخريطة
  const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/satellite-streets-v11',
    center: [lng, lat],
    zoom: 17,
    projection: 'globe'
  });

  // إضافة علامة على الموقع
  new mapboxgl.Marker({ color: 'red' })
    .setLngLat([lng, lat])
    .addTo(map);

  // استخدام reverse geocoding للحصول على العنوان
  fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${lng},${lat}.json?access_token=${mapboxgl.accessToken}`)
    .then(response => response.json())
    .then(data => {
      const place = data.features[0]?.place_name || "لم يتم العثور على عنوان";
      document.getElementById("location-address").textContent = `📍 موقعك الحالي: ${place}`;
    })
    .catch(error => {
      console.error("خطأ في جلب العنوان:", error);
      document.getElementById("location-address").textContent = "تعذر تحديد العنوان.";
    });

}, (err) => {
  console.error("فشل الحصول على الموقع:", err.message);
  document.getElementById("location-address").textContent = "لم يتم منح صلاحية الموقع.";
}, {
  enableHighAccuracy: true
});




  
  
</script>
<script src="{% static 'core/js/cardorder.js' %}"  ></script> 
{% endblock %}



</body>
</html> 